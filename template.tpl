___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "CHEQ Essentials",
  "categories": ["MARKETING"],
  "brand": {
    "id": "cheq.ai",
    "displayName": "CHEQ",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Prevent bots and malicious users from damaging your marketing performance with CHEQ Essentials. Use the template to install the tag.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "authenticationKey",
    "displayName": "Website authentication key",
    "simpleValueType": true,
    "help": "You can find your website’s authentication key by visiting the website management screen on your ClickCease dashboard, and clicking ‘get tag’. For more information, please contact support.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "STRING_LENGTH",
        "args": [
          5,
          100
        ],
        "errorMessage": "Key must be between 5 to 100 characters"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const queryPermission = require('queryPermission');
const injectScript = require('injectScript');
const sendPixel = require('sendPixel');

const baseUrl = 'http://obs.esnchocco.com/';
const key = ( data.authenticationKey || '' ).trim();

if (!key) return data.gtmOnFailure();

function onFailure() {
  const pixelUrl = baseUrl + 'ns/' + key + '.js';
  if (queryPermission('send_pixel', pixelUrl)) {
    sendPixel(pixelUrl);
  }
  data.gtmOnFailure();
}

const scriptUrl = baseUrl + 'i/' + key + '.js';
if (queryPermission('inject_script', scriptUrl)) {
  injectScript(scriptUrl, data.gtmOnSuccess, data.gtmOnFailure);
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://dani.soapfighters.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://dani.soapfighters.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []
setup: ''


___NOTES___

Created on 4/4/2023, 3:42:46 PM


